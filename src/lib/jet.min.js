function _classPrivateFieldLooseBase(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var id=0;function _classPrivateFieldLooseKey(e){return"__private_"+id+++"_"+e}class EventManager{constructor(e,{on:t={},once:s={}}){Object.defineProperty(this,_context,{writable:!0,value:void 0}),Object.defineProperty(this,_on,{writable:!0,value:{}}),Object.defineProperty(this,_once,{writable:!0,value:{}}),Object.defineProperty(this,_typeof,{writable:!0,value:e=>Array.isArray(e)?"array":typeof e}),Object.defineProperty(this,_applyNamespace,{writable:!0,value:e=>{let{namespace:t}=_classPrivateFieldLooseBase(this,_context)[_context];return t?`${t}.${e}`:e}}),_classPrivateFieldLooseBase(this,_context)[_context]=e,_classPrivateFieldLooseBase(this,_on)[_on]=t,_classPrivateFieldLooseBase(this,_once)[_once]=s}initialize(){for(let e in _classPrivateFieldLooseBase(this,_on)[_on])this.on(e,_classPrivateFieldLooseBase(this,_on)[_on][e]);for(let e in _classPrivateFieldLooseBase(this,_once)[_once])this.once(e,_classPrivateFieldLooseBase(this,_once)[_once][e])}emit(){arguments[0]=_classPrivateFieldLooseBase(this,_applyNamespace)[_applyNamespace](arguments[0]),NGN.BUS.emit(...arguments)}on(e,t){if("object"===_classPrivateFieldLooseBase(this,_typeof)[_typeof](t))return this.pool(...arguments);let s=_classPrivateFieldLooseBase(this,_context)[_context];NGN.BUS.on(_classPrivateFieldLooseBase(this,_applyNamespace)[_applyNamespace](e),(function(){t.call(s,...arguments)}))}once(e,t){if("object"===_classPrivateFieldLooseBase(this,_typeof)[_typeof](e))return this.pool(...arguments);let s=_classPrivateFieldLooseBase(this,_context)[_context];NGN.BUS.once(_classPrivateFieldLooseBase(this,_applyNamespace)[_applyNamespace](e),(function(){t.call(s,...arguments)}))}pool(e,t){if("object"===_classPrivateFieldLooseBase(this,_typeof)[_typeof](e)&&(t=e,e=""),NGN.isFn(t))return this.on(e,t);if("object"!==_classPrivateFieldLooseBase(this,_typeof)[_typeof](t))return console.error(`Invalid event configuration type "${_classPrivateFieldLooseBase(this,_typeof)[_typeof](t)}"`);for(let s in t)this.pool(`${e}.${s}`,t[s])}}var _context=_classPrivateFieldLooseKey("context"),_on=_classPrivateFieldLooseKey("on"),_once=_classPrivateFieldLooseKey("once"),_typeof=_classPrivateFieldLooseKey("typeof"),_applyNamespace=_classPrivateFieldLooseKey("applyNamespace");function _classPrivateFieldLooseBase$1(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var id$1=0;function _classPrivateFieldLooseKey$1(e){return"__private_"+id$1+++"_"+e}class PropertyManager{constructor(e,t){Object.defineProperty(this,_context$1,{writable:!0,value:void 0}),Object.defineProperty(this,_cfg,{writable:!0,value:null}),Object.defineProperty(this,_model,{writable:!0,value:new NGN.DATA.Model({autoid:!0,fields:{}})}),Object.defineProperty(this,_properties,{writable:!0,value:null}),_classPrivateFieldLooseBase$1(this,_context$1)[_context$1]=e,_classPrivateFieldLooseBase$1(this,_cfg)[_cfg]=NGN.coalesce(t,null)}get properties(){let{data:e}=_classPrivateFieldLooseBase$1(this,_properties)[_properties],t={};for(let s in e)Object.defineProperty(t,s,{get:()=>_classPrivateFieldLooseBase$1(this,_properties)[_properties][s],set:e=>_classPrivateFieldLooseBase$1(this,_properties)[_properties][s]=e});return t}get(e){return _classPrivateFieldLooseBase$1(this,_properties)[_properties][e]}initialize(){_classPrivateFieldLooseBase$1(this,_properties)[_properties]=new(_classPrivateFieldLooseBase$1(this,_model)[_model]);for(let e in _classPrivateFieldLooseBase$1(this,_cfg)[_cfg])_classPrivateFieldLooseBase$1(this,_properties)[_properties].addField(e,_classPrivateFieldLooseBase$1(this,_cfg)[_cfg][e]);_classPrivateFieldLooseBase$1(this,_properties)[_properties].on("field.update",e=>{e.old!==e.new&&(_classPrivateFieldLooseBase$1(this,_context$1)[_context$1].emit("property.changed",{property:e.field,old:e.old,new:e.new}),_classPrivateFieldLooseBase$1(this,_context$1)[_context$1].emit(`property.${e.field}.changed`,{old:e.old,new:e.new}))})}}var _context$1=_classPrivateFieldLooseKey$1("context"),_cfg=_classPrivateFieldLooseKey$1("cfg"),_model=_classPrivateFieldLooseKey$1("model"),_properties=_classPrivateFieldLooseKey$1("properties");function _classPrivateFieldLooseBase$2(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var id$2=0;function _classPrivateFieldLooseKey$2(e){return"__private_"+id$2+++"_"+e}class State{constructor(e,t){Object.defineProperty(this,_typeof$1,{writable:!0,value:e=>Array.isArray(e)?"array":typeof e}),Object.defineProperty(this,_getHandler,{writable:!0,value:(e,t)=>{if(e.hasOwnProperty(t))return"function"!==_classPrivateFieldLooseBase$2(this,_typeof$1)[_typeof$1](e[t])?null:e[t]}}),Object.defineProperty(this,_generateHookObject,{writable:!0,value:(e,t)=>{if(!e.hasOwnProperty(t))return null;return"function"===_classPrivateFieldLooseBase$2(this,_typeof$1)[_typeof$1](e[t])?e[t]:{once:_classPrivateFieldLooseBase$2(this,_generateOnceObject)[_generateOnceObject](e[t],t,"once"),onceEvery:_classPrivateFieldLooseBase$2(this,_generateThresholdObject)[_generateThresholdObject](e[t].onceEvery,t,"onceEvery"),onceAfter:_classPrivateFieldLooseBase$2(this,_generateThresholdObject)[_generateThresholdObject](e[t].onceAfter,t,"onceAfter"),on:NGN.coalesce(e[t].on)}}}),Object.defineProperty(this,_generateOnceObject,{writable:!0,value:e=>e.hasOwnProperty("once")?{called:!1,callback:_classPrivateFieldLooseBase$2(this,_getHandler)[_getHandler](e,"once")}:null}),Object.defineProperty(this,_generateThresholdObject,{writable:!0,value:(e,t=null,s=null)=>e?Array.isArray(e)?{max:NGN.coalesce(e[0]),callback:NGN.coalesce(e[1]),counter:0}:(console.error(`State ${this.name}${t?`.${t}`:""}.${s}: Invalid type "${typeof e}"`),null):null}),Object.defineProperty(this,_generateSequence,{writable:!0,value:e=>{if(!e)return null;if("function"==typeof e)return[{name:"on",callback:e}];let t=[];return e.once&&!e.once.called&&(t.push({name:"once",callback:e.once.callback}),e.once.called=!0),e.onceEvery&&(e.onceEvery.counter===e.onceEvery.max-1?(t.push({name:"onceEvery",callback:e.onceEvery.callback}),e.onceEvery.counter=0):e.onceEvery.counter++),e.onceAfter&&(e.onceAfter.counter===e.onceAfter.max&&t.push({name:"onceAfter",callback:e.onceAfter.callback}),e.onceAfter.counter++),e.on&&t.push({name:"on",callback:e.on}),t}}),this.name=e;let s=_classPrivateFieldLooseBase$2(this,_typeof$1)[_typeof$1](t);if("function"!==s){if("object"!==s)return console.error(`State "${e}": Invalid type [${s}]. State configurations must be defined as either functions or objects.`);this.transitions=NGN.coalesce(t.transitions,{}),this.on=_classPrivateFieldLooseBase$2(this,_getHandler)[_getHandler](t,"on"),this.off=_classPrivateFieldLooseBase$2(this,_getHandler)[_getHandler](t,"off"),this.once=_classPrivateFieldLooseBase$2(this,_generateOnceObject)[_generateOnceObject](t),this.onceEvery=_classPrivateFieldLooseBase$2(this,_generateThresholdObject)[_generateThresholdObject](t.onceEvery,null,"onceEvery"),this.onceAfter=_classPrivateFieldLooseBase$2(this,_generateThresholdObject)[_generateThresholdObject](t.onceAfter,null,"onceAfter"),["before","after"].forEach(e=>{this[e]=_classPrivateFieldLooseBase$2(this,_generateHookObject)[_generateHookObject](t,e)})}else this.on=t}get sequence(){return{before:_classPrivateFieldLooseBase$2(this,_generateSequence)[_generateSequence](this.before),on:_classPrivateFieldLooseBase$2(this,_generateSequence)[_generateSequence](this),after:_classPrivateFieldLooseBase$2(this,_generateSequence)[_generateSequence](this.after)}}hasTransition(e){return this.transitions.hasOwnProperty(e)}getTransition(e){return this.hasTransition(e)?this.transitions[e]:console.error(`"${e}" is not a valid transition on the "${this.name}" state`)}}var _typeof$1=_classPrivateFieldLooseKey$2("typeof"),_getHandler=_classPrivateFieldLooseKey$2("getHandler"),_generateHookObject=_classPrivateFieldLooseKey$2("generateHookObject"),_generateOnceObject=_classPrivateFieldLooseKey$2("generateOnceObject"),_generateThresholdObject=_classPrivateFieldLooseKey$2("generateThresholdObject"),_generateSequence=_classPrivateFieldLooseKey$2("generateSequence");function _classPrivateFieldLooseBase$3(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var id$3=0;function _classPrivateFieldLooseKey$3(e){return"__private_"+id$3+++"_"+e}class StateManager{constructor(e,t,s){Object.defineProperty(this,_context$2,{writable:!0,value:null}),Object.defineProperty(this,_states,{writable:!0,value:{}}),Object.defineProperty(this,_current,{writable:!0,value:null}),Object.defineProperty(this,_previous,{writable:!0,value:null}),Object.defineProperty(this,_initialState,{writable:!0,value:null}),Object.defineProperty(this,_payload,{writable:!0,value:null}),Object.defineProperty(this,_typeof$2,{writable:!0,value:e=>Array.isArray(e)?"array":typeof e}),Object.defineProperty(this,_runSequence,{writable:!0,value:(e,t,s,a)=>{let{name:r}=e;if(!t||!t.length)return a();let i=new NGN.Tasks;t.forEach((e,t)=>{i.add(`Running ${r} state "${s} ${e.name}" callback...`,async t=>{await e.callback.call(_classPrivateFieldLooseBase$3(this,_context$2)[_context$2],_classPrivateFieldLooseBase$3(this,_previous)[_previous]?_classPrivateFieldLooseBase$3(this,_previous)[_previous].name:null,...NGN.coalesce(_classPrivateFieldLooseBase$3(this,_payload)[_payload],[])),t()})}),i.on("complete",a),i.run(!0)}}),Object.defineProperty(this,_execChange,{writable:!0,value:e=>{let t=new NGN.Tasks;if(_classPrivateFieldLooseBase$3(this,_current)[_current]){let{name:s,off:a}=_classPrivateFieldLooseBase$3(this,_current)[_current];t.add("Firing state change event...",t=>{_classPrivateFieldLooseBase$3(this,_context$2)[_context$2].emit("state.change",{current:s,next:e.name},...NGN.coalesce(_classPrivateFieldLooseBase$3(this,_payload)[_payload],[])),t()}),a&&t.add("Running previous state off callback...",async e=>{await a.call(_classPrivateFieldLooseBase$3(this,_context$2)[_context$2],s,...NGN.coalesce(_classPrivateFieldLooseBase$3(this,_payload)[_payload],[])),e()})}let{sequence:s}=e;s.before&&t.add("Running before-state-change sequence...",t=>{_classPrivateFieldLooseBase$3(this,_runSequence)[_runSequence](e,s.before,"before",t)}),_classPrivateFieldLooseBase$3(this,_previous)[_previous]=NGN.coalesce(_classPrivateFieldLooseBase$3(this,_current)[_current]),_classPrivateFieldLooseBase$3(this,_current)[_current]=e,["on","after"].forEach(e=>{t.add(`Running ${e}-state-change sequence...`,t=>{_classPrivateFieldLooseBase$3(this,_runSequence)[_runSequence](_classPrivateFieldLooseBase$3(this,_current)[_current],s[e],e,t)})}),t.on("complete",()=>{_classPrivateFieldLooseBase$3(this,_previous)[_previous]?_classPrivateFieldLooseBase$3(this,_context$2)[_context$2].emit("state.changed",{old:_classPrivateFieldLooseBase$3(this,_previous)[_previous].name,new:_classPrivateFieldLooseBase$3(this,_current)[_current].name},...NGN.coalesce(_classPrivateFieldLooseBase$3(this,_payload)[_payload],[])):_classPrivateFieldLooseBase$3(this,_context$2)[_context$2].emit("state.initialized",{old:null,new:_classPrivateFieldLooseBase$3(this,_current)[_current].name},...NGN.coalesce(_classPrivateFieldLooseBase$3(this,_payload)[_payload],[]))}),t.run(!0)}}),_classPrivateFieldLooseBase$3(this,_context$2)[_context$2]=NGN.coalesce(e);for(let e in t)this.add(e,t[e]);_classPrivateFieldLooseBase$3(this,_states)[_states].hasOwnProperty("idle")||(_classPrivateFieldLooseBase$3(this,_states)[_states].idle=new State("idle",(function(){}))),_classPrivateFieldLooseBase$3(this,_initialState)[_initialState]=_classPrivateFieldLooseBase$3(this,_states)[_states][NGN.coalesce(s,"idle")]}get current(){return _classPrivateFieldLooseBase$3(this,_current)[_current]}set current(e){if(!(e=NGN.coalesce(this.get(e))))return _classPrivateFieldLooseBase$3(this,_payload)[_payload]=null,console.error(`State "${e}" not found`);_classPrivateFieldLooseBase$3(this,_execChange)[_execChange](e)}get previous(){return _classPrivateFieldLooseBase$3(this,_previous)[_previous]}get states(){return Object.keys(_classPrivateFieldLooseBase$3(this,_states)[_states])}add(e,t){if(this.has(e))return console.error(`State "${e}" already exists`);let s=_classPrivateFieldLooseBase$3(this,_typeof$2)[_typeof$2](t);if("object"!==s&&"function"!==s)return console.error(`Invalid state configuration type "${s}"`);_classPrivateFieldLooseBase$3(this,_states)[_states][e]=new State(e,t)}get(e){return this.has(e)?_classPrivateFieldLooseBase$3(this,_states)[_states][e]:console.error(`State "${e}" not found.`)}has(e){return _classPrivateFieldLooseBase$3(this,_states)[_states].hasOwnProperty(e)}initialize(){_classPrivateFieldLooseBase$3(this,_execChange)[_execChange](_classPrivateFieldLooseBase$3(this,_initialState)[_initialState])}remove(e){return this.has(e)?"idle"===e?console.error("Cannot remove idle state."):(this.current.name===e&&(console.warn(`"${e}" is the currently active state. Reverting to idle state...`),this.current="idle"),void delete _classPrivateFieldLooseBase$3(this,_states)[_states][e]):console.error(`State "${e}" does not exist.`)}transition(e,...t){switch(e=_classPrivateFieldLooseBase$3(this,_current)[_current].getTransition(e),_classPrivateFieldLooseBase$3(this,_typeof$2)[_typeof$2](e)){case"string":return _classPrivateFieldLooseBase$3(this,_payload)[_payload]=t,this.current=e;case"function":return e.call(_classPrivateFieldLooseBase$3(this,_context$2)[_context$2],...t);case"object":return console.log(e)}}setState(e,...t){if("string"!==_classPrivateFieldLooseBase$3(this,_typeof$2)[_typeof$2](e))return console.error(`Invalid state identifier type "${_classPrivateFieldLooseBase$3(this,_typeof$2)[_typeof$2](e)}"`);_classPrivateFieldLooseBase$3(this,_payload)[_payload]=t,this.current=e}}var _context$2=_classPrivateFieldLooseKey$3("context"),_states=_classPrivateFieldLooseKey$3("states"),_current=_classPrivateFieldLooseKey$3("current"),_previous=_classPrivateFieldLooseKey$3("previous"),_initialState=_classPrivateFieldLooseKey$3("initialState"),_payload=_classPrivateFieldLooseKey$3("payload"),_typeof$2=_classPrivateFieldLooseKey$3("typeof"),_runSequence=_classPrivateFieldLooseKey$3("runSequence"),_execChange=_classPrivateFieldLooseKey$3("execChange");class Utilities{static elementIsVisible(e,t=!1){let s=e.getBoundingClientRect(),a=s.bottom>0&&s.right>0;return t?a:a&&s.top>0&&s.left>0}static createGUID(){let e=[];for(let t=0;t<256;t++)e[t]=(t<16?"0":"")+t.toString(16);const t=4294967295*Math.random()|0,s=4294967295*Math.random()|0,a=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return e[255&t]+e[t>>8&255]+e[t>>16&255]+e[t>>24&255]+"-"+e[255&s]+e[s>>8&255]+"-"+e[s>>16&15|64]+e[s>>24&255]+"-"+e[63&a|128]+e[a>>8&255]+"-"+e[a>>16&255]+e[a>>24&255]+e[255&r]+e[r>>8&255]+e[r>>16&255]+e[r>>24&255]}}class Reference{constructor(e){if(this.element=NGN.coalesce(e),this.element)return new Proxy(this,{get:(e,t)=>t in e.element?Reflect.get(e.element,t):Reflect.get(e,t),set:(e,t,s)=>t in e.element?Reflect.set(e.element,t,s):Reflect.set(e,t,s)})}on(e,t){this.element.addEventListener(...arguments)}off(e,t){this.element.removeEventListener(...arguments)}destroy(){if(!this.element)return console.error("Reference element does not exist");this.element.parentNode.removeChild(element)}}let _Symbol$iterator,_Symbol$toStringTag;function _classPrivateFieldLooseBase$4(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var id$4=0;function _classPrivateFieldLooseKey$4(e){return"__private_"+id$4+++"_"+e}_Symbol$iterator=Symbol.iterator,_Symbol$toStringTag=Symbol.toStringTag;class JetReferenceCollection{constructor(e=null){if(Object.defineProperty(this,_references,{writable:!0,value:void 0}),"array"!==NGN.typeof(e))return console.error(`Invalid argument type "${NGN.typeof(e)}". JetReferenceCollection expects an array.`);_classPrivateFieldLooseBase$4(this,_references)[_references]=e,_classPrivateFieldLooseBase$4(this,_references)[_references].forEach((e,t)=>{this[t]=e,e.id&&(this[e.id]=e)})}get length(){return _classPrivateFieldLooseBase$4(this,_references)[_references].length}forEach(e){_classPrivateFieldLooseBase$4(this,_references)[_references].forEach(e)}item(e){return this[e]}namedItem(e){let t=_classPrivateFieldLooseBase$4(this,_references)[_references].filter(t=>t.id===e||t.name===e);return t.length>0?t[0]:null}[_Symbol$iterator](){let e=0;return{next:()=>{let t={value:this[e],done:!(e in this)};return e++,t}}}[_Symbol$toStringTag](){return"JetReferenceCollection"}}var _references=_classPrivateFieldLooseKey$4("references");function _classPrivateFieldLooseBase$5(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var id$5=0;function _classPrivateFieldLooseKey$5(e){return"__private_"+id$5+++"_"+e}class ReferenceManager{constructor(e,t){Object.defineProperty(this,_context$3,{writable:!0,value:void 0}),Object.defineProperty(this,_cfg$1,{writable:!0,value:void 0}),Object.defineProperty(this,_self,{writable:!0,value:void 0}),Object.defineProperty(this,_handlers,{writable:!0,value:new Map}),Object.defineProperty(this,_reservedNames,{writable:!0,value:["add","remove","self"]}),Object.defineProperty(this,_applyContext,{writable:!0,value:e=>`${_classPrivateFieldLooseBase$5(this,_context$3)[_context$3].selector?`${_classPrivateFieldLooseBase$5(this,_context$3)[_context$3].selector} `:""}${e}`}),Object.defineProperty(this,_referenceIsValid,{writable:!0,value:(e,t)=>{let s=NGN.typeof(t);return"string"!==s?(console.error(`Invalid reference "${e}". Expected selector string but got "${s}"`),!1):!_classPrivateFieldLooseBase$5(this,_reservedNames)[_reservedNames].includes(e)||(console.error(`Invalid reference "${e}". "${e}" is a reserved word`),!1)}}),Object.defineProperty(this,_registerHandler,{writable:!0,value:(e,t,s,a,r=0)=>{let i={event:s,type:t,callback:a};if(!_classPrivateFieldLooseBase$5(this,_handlers)[_handlers].has(e))return _classPrivateFieldLooseBase$5(this,_handlers)[_handlers].set(e,[i]);let o=_classPrivateFieldLooseBase$5(this,_handlers)[_handlers].get(e);o.some(e=>e.callback===a)||o.push(i)}}),Object.defineProperty(this,_unregisterHandler,{writable:!0,value:(e,t,s)=>{if(!_classPrivateFieldLooseBase$5(this,_handlers)[_handlers].has(e))return console.error("Reference element not found");let a=_classPrivateFieldLooseBase$5(this,_handlers)[_handlers].get(e).filter(e=>e.callback!==s);if(0===a.length)return _classPrivateFieldLooseBase$5(this,_handlers)[_handlers].delete(e);_classPrivateFieldLooseBase$5(this,_handlers)[_handlers].set(e,a)}}),Object.defineProperty(this,_unregisterAllHandlers,{writable:!0,value:e=>_classPrivateFieldLooseBase$5(this,_handlers)[_handlers].delete(e)}),_classPrivateFieldLooseBase$5(this,_context$3)[_context$3]=e,t=NGN.coalesce(t,{});for(let e in t)_classPrivateFieldLooseBase$5(this,_referenceIsValid)[_referenceIsValid](e,t[e])||delete t[e];"TemplateInstance"!==_classPrivateFieldLooseBase$5(this,_context$3)[_context$3].constructor.name&&(t=Object.assign(t,{self:_classPrivateFieldLooseBase$5(this,_context$3)[_context$3].selector})),_classPrivateFieldLooseBase$5(this,_cfg$1)[_cfg$1]=t}initialize(e){e&&(_classPrivateFieldLooseBase$5(this,_self)[_self]=e),_classPrivateFieldLooseBase$5(this,_handlers)[_handlers].clear()}get length(){return Object.keys(_classPrivateFieldLooseBase$5(this,_cfg$1)[_cfg$1]).length}get references(){let e=this;return new class{constructor(t){this.self=_classPrivateFieldLooseBase$5(e,_context$3)[_context$3].self;for(let s in t)"self"!==s&&(this[s]=NGN.coalesce(e.getReference(s,this.self)))}get length(){return e.length}add(){e.addReference(...arguments)}remove(){e.removeReference(...arguments)}get(){return e.getReference(...arguments)}has(){return e.hasReference(...arguments)}}(_classPrivateFieldLooseBase$5(this,_cfg$1)[_cfg$1])}addReference(e,t){if(_classPrivateFieldLooseBase$5(this,_referenceIsValid)[_referenceIsValid](...arguments))return _classPrivateFieldLooseBase$5(this,_cfg$1)[_cfg$1].hasOwnProperty(e)?console.error(`Reference "${e}" already exists`):void(_classPrivateFieldLooseBase$5(this,_cfg$1)[_cfg$1][e]=t)}removeReference(e){if(!_classPrivateFieldLooseBase$5(this,_cfg$1)[_cfg$1].hasOwnProperty(e))return console.error(`Reference "${e}" not found.`);delete _classPrivateFieldLooseBase$5(this,_cfg$1)[_cfg$1][e]}getReference(e,t=null){return _classPrivateFieldLooseBase$5(this,_cfg$1)[_cfg$1].hasOwnProperty(e)?this.createReference(e,_classPrivateFieldLooseBase$5(this,_cfg$1)[_cfg$1][e],t):(console.error(`Reference "${e}" not found`),null)}createReference(e,t,s=null){let a=this;class r extends Reference{constructor(e,t){super(t),Object.defineProperty(this,i,{writable:!0,value:void 0}),_classPrivateFieldLooseBase$5(this,i)[i]=e}on(e,t){if("object"===NGN.typeof(e))return this.pool(e);_classPrivateFieldLooseBase$5(a,_registerHandler)[_registerHandler](this.element,"on",...arguments),super.on(...arguments)}off(e,t){return"all"===e?this.offAll():t?(_classPrivateFieldLooseBase$5(a,_unregisterHandler)[_unregisterHandler](this.element,...arguments),void super.off(...arguments)):_classPrivateFieldLooseBase$5(a,_handlers)[_handlers].get(this.element).filter(t=>t.event===e).forEach(e=>{super.off(e.event,e.callback),_classPrivateFieldLooseBase$5(a,_unregisterHandler)[_unregisterHandler](this.element,e.event,e.callback)})}offAll(){_classPrivateFieldLooseBase$5(a,_handlers)[_handlers].get(this.element).forEach(e=>{super.off(e.event,e.callback)}),_classPrivateFieldLooseBase$5(a,_unregisterAllHandlers)[_unregisterAllHandlers](this.element)}once(e,t){let s=()=>{t(...arguments),this.off(e,s)};this.on(e,s)}pool(e,t=!1){for(let s in e)t?this.once(s,e[s]):this.on(s,e[s])}}var i=_classPrivateFieldLooseKey$5("name");if("self"===e&&!_classPrivateFieldLooseBase$5(this,_cfg$1)[_cfg$1].self)return new r(e,_classPrivateFieldLooseBase$5(this,_self)[_self]);let o=s?s.element.querySelectorAll(t):document.querySelectorAll(t);switch(o.length){case 0:return null;case 1:return new r(e,o[0]);default:return new JetReferenceCollection([...o].map((e,t)=>new r(t,e)))}}hasReference(e){return _classPrivateFieldLooseBase$5(this,_cfg$1)[_cfg$1].hasOwnProperty(e)}}var _context$3=_classPrivateFieldLooseKey$5("context"),_cfg$1=_classPrivateFieldLooseKey$5("cfg"),_self=_classPrivateFieldLooseKey$5("self"),_handlers=_classPrivateFieldLooseKey$5("handlers"),_reservedNames=_classPrivateFieldLooseKey$5("reservedNames"),_applyContext=_classPrivateFieldLooseKey$5("applyContext"),_referenceIsValid=_classPrivateFieldLooseKey$5("referenceIsValid"),_registerHandler=_classPrivateFieldLooseKey$5("registerHandler"),_unregisterHandler=_classPrivateFieldLooseKey$5("unregisterHandler"),_unregisterAllHandlers=_classPrivateFieldLooseKey$5("unregisterAllHandlers");function _classPrivateFieldLooseBase$6(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var id$6=0;function _classPrivateFieldLooseKey$6(e){return"__private_"+id$6+++"_"+e}class ReactionManager{constructor(e,t=null){Object.defineProperty(this,_context$4,{writable:!0,value:void 0}),Object.defineProperty(this,_reactions,{writable:!0,value:null}),Object.defineProperty(this,_parent,{writable:!0,value:void 0}),Object.defineProperty(this,_handleParentStateChange,{writable:!0,value:e=>{_classPrivateFieldLooseBase$6(this,_reactions)[_reactions]&&_classPrivateFieldLooseBase$6(this,_reactions)[_reactions].hasOwnProperty(e.current)&&(_classPrivateFieldLooseBase$6(this,_context$4)[_context$4].state=_classPrivateFieldLooseBase$6(this,_reactions)[_reactions][e.current])}}),_classPrivateFieldLooseBase$6(this,_context$4)[_context$4]=e,_classPrivateFieldLooseBase$6(this,_parent)[_parent]=NGN.coalesce(e.parent),_classPrivateFieldLooseBase$6(this,_reactions)[_reactions]=t}initialize(){if(_classPrivateFieldLooseBase$6(this,_parent)[_parent]=_classPrivateFieldLooseBase$6(this,_context$4)[_context$4].parent,_classPrivateFieldLooseBase$6(this,_reactions)[_reactions])for(let e in _classPrivateFieldLooseBase$6(this,_reactions)[_reactions]){let t=_classPrivateFieldLooseBase$6(this,_reactions)[_reactions][e];if(Array.isArray(t)){console.error('Invalid reaction type "array"');continue}let s=typeof t;if("object"===s){let s=t;for(let t in s)_classPrivateFieldLooseBase$6(this,_context$4)[_context$4].on(`${e}.state.changed`,e=>{if(e.current===t)switch(typeof s[t]){case"string":_classPrivateFieldLooseBase$6(this,_context$4)[_context$4].state=s[t];break;case"function":return s[t].call(_classPrivateFieldLooseBase$6(this,_context$4)[_context$4])}});return}_classPrivateFieldLooseBase$6(this,_parent)[_parent]&&_classPrivateFieldLooseBase$6(this,_parent)[_parent].on("state.changed",a=>{if(a.current===e)switch(s){case"string":_classPrivateFieldLooseBase$6(this,_context$4)[_context$4].state=t;break;case"function":return t.call(_classPrivateFieldLooseBase$6(this,_context$4)[_context$4])}})}}get hasParent(){return!!_classPrivateFieldLooseBase$6(this,_parent)[_parent]}set parent(e){this.hasParent&&_classPrivateFieldLooseBase$6(this,_parent)[_parent].off("state.changed",_classPrivateFieldLooseBase$6(this,_handleParentStateChange)[_handleParentStateChange]),e&&(_classPrivateFieldLooseBase$6(this,_parent)[_parent]=e,_classPrivateFieldLooseBase$6(this,_parent)[_parent].on("state.changed",_classPrivateFieldLooseBase$6(this,_handleParentStateChange)[_handleParentStateChange]))}}var _context$4=_classPrivateFieldLooseKey$6("context"),_reactions=_classPrivateFieldLooseKey$6("reactions"),_parent=_classPrivateFieldLooseKey$6("parent"),_handleParentStateChange=_classPrivateFieldLooseKey$6("handleParentStateChange");function _classPrivateFieldLooseBase$7(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var id$7=0;function _classPrivateFieldLooseKey$7(e){return"__private_"+id$7+++"_"+e}class TemplateInstance{constructor(e,t=null){Object.defineProperty(this,_namespace,{writable:!0,value:void 0}),Object.defineProperty(this,_referenceManager,{writable:!0,value:void 0}),Object.defineProperty(this,_renderFn,{writable:!0,value:void 0}),Object.defineProperty(this,_applyNamespace$1,{writable:!0,value:e=>`${this.namespace}.${e}`}),this.parent=t,_classPrivateFieldLooseBase$7(this,_namespace)[_namespace]=NGN.coalesce(e.namespace,Utilities.createGUID()),_classPrivateFieldLooseBase$7(this,_renderFn)[_renderFn]=NGN.coalesce(e.render),_classPrivateFieldLooseBase$7(this,_referenceManager)[_referenceManager]=new ReferenceManager(this,NGN.coalesce(e.references))}get namespace(){return`${this.parent?`${this.parent.namespace}.`:""}${_classPrivateFieldLooseBase$7(this,_namespace)[_namespace]}`}get type(){return"template"}get references(){return _classPrivateFieldLooseBase$7(this,_referenceManager)[_referenceManager].references}get refs(){return this.references}emit(){arguments[0]=_classPrivateFieldLooseBase$7(this,_applyNamespace$1)[_applyNamespace$1](arguments[0]),NGN.BUS.emit(...arguments)}render(){let e=_classPrivateFieldLooseBase$7(this,_renderFn)[_renderFn]?_classPrivateFieldLooseBase$7(this,_renderFn)[_renderFn](...arguments):null;return e&&_classPrivateFieldLooseBase$7(this,_referenceManager)[_referenceManager].initialize(),e}}var _namespace=_classPrivateFieldLooseKey$7("namespace"),_referenceManager=_classPrivateFieldLooseKey$7("referenceManager"),_renderFn=_classPrivateFieldLooseKey$7("renderFn"),_applyNamespace$1=_classPrivateFieldLooseKey$7("applyNamespace");const Template=function(e){return{type:"template",namespace:NGN.coalesce(e.namespace),render:NGN.coalesce(e.render),references:NGN.coalesce(e.references)}};function _classPrivateFieldLooseBase$8(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var id$8=0;function _classPrivateFieldLooseKey$8(e){return"__private_"+id$8+++"_"+e}class VirtualNode{constructor({tag:e,attributes:t,on:s,children:a}){Object.defineProperty(this,_resolveClassList,{writable:!0,value:(...e)=>e.reduce((e,t)=>{switch(NGN.typeof(t)){case"object":return[...e,...Object.keys(t).filter(e=>!0===t[e])];case"number":case"string":return[...e,t]}},[]).join(" ")}),this.tag=NGN.coalesce(e),t&&NGN.coalesce(t.class)&&"array"===NGN.typeof(t.class)&&(t.class=_classPrivateFieldLooseBase$8(this,_resolveClassList)[_resolveClassList](...t.class)),this.attributes=NGN.coalesce(t),this.listeners=NGN.coalesce(s,{}),this.children=NGN.coalesce(a,[]).filter(Boolean),this.interface=null}get hasAttributes(){return!!this.attributes&&Object.keys(this.attributes).length>0}get hasChildren(){return this.children.length>0}get hasListeners(){return!!this.listeners&&Object.keys(this.listeners).length>0}get isBound(){return!!this.interface}hasAttribute(e){return this.attributes.hasOwnProperty(e)}hasListener(e){return this.listeners.hasOwnProperty(e)}initialize(e,t){this.interface.initialize(e,t)}}var _resolveClassList=_classPrivateFieldLooseKey$8("resolveClassList");class Renderer{constructor(e){Object.defineProperty(this,_context$5,{writable:!0,value:void 0}),Object.defineProperty(this,_cachedElements,{writable:!0,value:new Map}),Object.defineProperty(this,_parser,{writable:!0,value:new DOMParser}),Object.defineProperty(this,_trash,{writable:!0,value:[]}),Object.defineProperty(this,_boundNodes,{writable:!0,value:new Map}),Object.defineProperty(this,_addAttributes,{writable:!0,value:(e,t)=>{for(let s in t){let a=t[s];if("boolean"!=typeof a)e.setAttribute(s,_classPrivateFieldLooseBase$8(this,_parser)[_parser].parseFromString(a,"text/html").body.textContent);else{if(!a)continue;e.setAttribute(s,"")}}}}),Object.defineProperty(this,_removeAttributes,{writable:!0,value:(e,t)=>{if(t)for(let s in t)e.removeAttribute(s);else for(;e.attributes.length>0;)e.removeAttribute(e.attributes[0].name)}}),Object.defineProperty(this,_addListeners,{writable:!0,value:(e,t)=>{for(let s in t)e.addEventListener(s,t[s])}}),Object.defineProperty(this,_removeListeners,{writable:!0,value:(e,t)=>{for(let s in t)e.removeEventListener(s,t[s])}}),Object.defineProperty(this,_appendChildNode,{writable:!0,value:(e,t)=>{e.appendChild(_classPrivateFieldLooseBase$8(this,_processVirtualNode)[_processVirtualNode](t))}}),Object.defineProperty(this,_appendChildNodes,{writable:!0,value:(e,t=[])=>{0!==t.length&&t.forEach(t=>{null!=t&&_classPrivateFieldLooseBase$8(this,_appendChildNode)[_appendChildNode](e,t)})}}),Object.defineProperty(this,_clearChildNodes,{writable:!0,value:e=>{for(;e.lastChild;)e.removeChild(e.lastChild);return e}}),Object.defineProperty(this,_createNode,{writable:!0,value:(e,t=!1)=>{if("string"==typeof e||"number"==typeof e){let t=_classPrivateFieldLooseBase$8(this,_parser)[_parser].parseFromString(e,"text/html").body.textContent;return document.createTextNode(t)}return document.createElement(e.tag)}}),Object.defineProperty(this,_nodeIsEmpty,{writable:!0,value:e=>[...e.childNodes].every(e=>3===e.nodeType&&!e.data.trim()||8===e.nodeType)}),Object.defineProperty(this,_parseElement,{writable:!0,value:e=>new VirtualNode({tag:e.localName,attributes:[...e.attributes].reduce((e,t)=>(e[t.name]=t.value,e),{}),children:e.childNodes.length>0?[...e.childNodes].map(e=>{switch(e.nodeType){case 1:return _classPrivateFieldLooseBase$8(this,_parseElement)[_parseElement](e);case 3:return e.data;default:return null}}):[]})}),Object.defineProperty(this,_processChildren,{writable:!0,value:e=>{if("array"!==NGN.typeof(e))throw new Error("Children must be an array");return e.reduce((e,t)=>{if(!t)return e;if(t instanceof VirtualNode)return[...e,t];let s=NGN.typeof(t);switch(s){case"string":case"number":return[...e,`${t}`];case"object":return"CustomElement"===t.constructor.name?[...e,..._classPrivateFieldLooseBase$8(this,_processCustomElement)[_processCustomElement](t)]:[...e,..._classPrivateFieldLooseBase$8(this,_processTemplate)[_processTemplate](t)]}if("array"!==s)throw new Error(`Invalid child element type "${typeof t}"`);if(s=NGN.typeof(t[0]),"object"===s)return[...e,..._classPrivateFieldLooseBase$8(this,_processTemplate)[_processTemplate](t[0],t.slice(1))];let a=this.createVirtualNode(...t);return a.children.length>0&&(a.children=_classPrivateFieldLooseBase$8(this,_processChildren)[_processChildren](a.children)),[...e,a]},[])}}),Object.defineProperty(this,_processCustomElement,{writable:!0,value:e=>(console.log(e),_classPrivateFieldLooseBase$8(this,_processChildren)[_processChildren]([[e.tag]]))}),Object.defineProperty(this,_processTemplate,{writable:!0,value:(e,t=[])=>{let s=new TemplateInstance(e,_classPrivateFieldLooseBase$8(this,_context$5)[_context$5]);return _classPrivateFieldLooseBase$8(this,_processChildren)[_processChildren](s.render(...t))}}),Object.defineProperty(this,_processVirtualNode,{writable:!0,value:e=>{let t=_classPrivateFieldLooseBase$8(this,_createNode)[_createNode](e);if(e.hasAttributes)for(let s in e.attributes){let a=e.attributes[s],r=NGN.typeof(a);"boolean"===r?a?t.setAttribute(s,""):t.removeAttribute(s):t.setAttribute(s,"function"===r?a():_classPrivateFieldLooseBase$8(this,_parser)[_parser].parseFromString(a,"text/html").body.textContent)}if(e.hasListeners)for(let s in e.listeners)t.addEventListener(s,e.listeners[s]);return e.hasChildren&&_classPrivateFieldLooseBase$8(this,_appendChildNodes)[_appendChildNodes](t,e.children),e.isBound&&_classPrivateFieldLooseBase$8(this,_boundNodes)[_boundNodes].set(e,t),t}}),Object.defineProperty(this,_reconcileAttributes,{writable:!0,value:(e,t)=>{if(t.new.hasAttributes&&!t.old.hasAttributes)return _classPrivateFieldLooseBase$8(this,_addAttributes)[_addAttributes](e,t.new.attributes);if(!t.new.hasAttributes&&t.old.hasAttributes)return _classPrivateFieldLooseBase$8(this,_removeAttributes)[_removeAttributes](e,t.old.attributes);for(let s in Object.assign({},t.new.attributes,t.old.attributes)){let a=t.new.hasAttribute(s),r=a&&t.old.hasAttribute(s);if(!(!!r&&t.new.attributes[s]===t.old.attributes[s]))if(r||a){let a=t.new.attributes[s];"boolean"==typeof a?a?e.setAttribute(s,""):e.removeAttribute(s):e.setAttribute(s,_classPrivateFieldLooseBase$8(this,_parser)[_parser].parseFromString(a,"text/html").body.textContent)}else e.removeAttribute(s)}}}),Object.defineProperty(this,_reconcileListeners,{writable:!0,value:(e,t)=>{if(t.new.hasListeners&&!t.old.hasListeners)return _classPrivateFieldLooseBase$8(this,_addListeners)[_addListeners](e,t.new.listeners);if(!t.new.hasListeners&&t.old.hasListeners)return _classPrivateFieldLooseBase$8(this,_removeListeners)[_removeListeners](e,t.old.listeners);for(let s in Object.assign({},t.new.listeners,t.old.listeners)){let a=t.new.hasListener(s),r=a&&t.old.hasListener(s);!!r&&t.new.listeners[s]===t.old.listeners[s]||(r&&e.removeEventListener(s,t.old.listeners[s]),a&&e.addEventListener(s,t.new.listeners[s]))}}}),Object.defineProperty(this,_reconcileChildNodes,{writable:!0,value:(e,t,s)=>{for(let a=0;a<Math.max(t.length,s.length);a++)_classPrivateFieldLooseBase$8(this,_reconcileNodes)[_reconcileNodes]({target:e,state:{old:NGN.coalesce(s[a]),new:NGN.coalesce(t[a])},index:a});_classPrivateFieldLooseBase$8(this,_trash)[_trash].reduce((e,t)=>t.remove(),[])}}),Object.defineProperty(this,_reconcileNodes,{writable:!0,value:({target:e,state:t={old:null,new:null},index:s=0})=>{let a=e.childNodes[s];if(!t.new)return void(a&&_classPrivateFieldLooseBase$8(this,_trash)[_trash].push(a));if(!a)return _classPrivateFieldLooseBase$8(this,_appendChildNode)[_appendChildNode](e,t.new);let r=NGN.typeof(t.new);return r!==typeof t.old?_classPrivateFieldLooseBase$8(this,_replaceChildNode)[_replaceChildNode](e,a,t.new):"string"===r?_classPrivateFieldLooseBase$8(this,_replaceChildNode)[_replaceChildNode](e,a,t.new):"object"!==r?console.error("Invalid rendering configuration."):t.new.tag!==t.old.tag?_classPrivateFieldLooseBase$8(this,_replaceChildNode)[_replaceChildNode](e,a,t.new):(_classPrivateFieldLooseBase$8(this,_reconcileChildNodes)[_reconcileChildNodes](a,t.new.children,t.old.children),_classPrivateFieldLooseBase$8(this,_reconcileAttributes)[_reconcileAttributes](a,t),_classPrivateFieldLooseBase$8(this,_reconcileListeners)[_reconcileListeners](a,t),void(t.new.isBound&&t.new.initialize(_classPrivateFieldLooseBase$8(this,_context$5)[_context$5],a)))}}),Object.defineProperty(this,_replaceChildNode,{writable:!0,value:(e,t,s)=>{e.replaceChild(_classPrivateFieldLooseBase$8(this,_processVirtualNode)[_processVirtualNode](s),t)}}),Object.defineProperty(this,_renderHTML,{writable:!0,value:(e,t=[])=>new Promise((s,a)=>{if("string"==typeof t)return e.innerHTML=t,s(e);if(0===t.length)return s(e=_classPrivateFieldLooseBase$8(this,_clearChildNodes)[_clearChildNodes](e));let r=_classPrivateFieldLooseBase$8(this,_cachedElements)[_cachedElements].get(e);r.hasChildren?_classPrivateFieldLooseBase$8(this,_reconcileChildNodes)[_reconcileChildNodes](e,t,r.children):_classPrivateFieldLooseBase$8(this,_appendChildNodes)[_appendChildNodes](e,t),r.children=t,_classPrivateFieldLooseBase$8(this,_boundNodes)[_boundNodes].forEach((e,t)=>t.initialize(_classPrivateFieldLooseBase$8(this,_context$5)[_context$5],e)),_classPrivateFieldLooseBase$8(this,_boundNodes)[_boundNodes].clear(),s(e)})}),_classPrivateFieldLooseBase$8(this,_context$5)[_context$5]=e}createVirtualNode(...e){if(0===e.length||!e[0])throw new Error("Cannot create element: Invalid Configuration.");let t=NGN.typeof(e[0]);if("object"===t)return new VirtualNode(e[0]);if("string"!==t)throw new Error("Cannot create element: Invalid Configuration.");let s={tag:e[0],attributes:null,on:null,children:null};if(e.length>=2)switch(NGN.typeof(e[1])){case"object":s.attributes=e[1];break;case"array":s.children=_classPrivateFieldLooseBase$8(this,_processChildren)[_processChildren](e[1])}if(e.length>=3)switch(NGN.typeof(e[2])){case"object":s.on=e[2];break;case"array":s.children=_classPrivateFieldLooseBase$8(this,_processChildren)[_processChildren](e[2])}return e.length>=4&&(s.children=_classPrivateFieldLooseBase$8(this,_processChildren)[_processChildren](e[3])),new VirtualNode(s)}clearCache(){_classPrivateFieldLooseBase$8(this,_cachedElements)[_cachedElements].clear()}generateHTML(e){let t=document.createElement("div");return _classPrivateFieldLooseBase$8(this,_appendChildNodes)[_appendChildNodes](t,_classPrivateFieldLooseBase$8(this,_processChildren)[_processChildren](e)),t.innerHTML}render(e,t,s=!1,a=!1){if(e instanceof VirtualNode||"array"===NGN.typeof(e)){let{self:s}=_classPrivateFieldLooseBase$8(this,_context$5)[_context$5];if(!s.element)throw new Error("Cannot render because Interface has no self-reference");t=e,e=s.element}else if(e.hasOwnProperty("element")&&e.element instanceof HTMLElement)e=e.element;else if(!(e instanceof HTMLElement))throw new Error("Invalid target element");return(s||_classPrivateFieldLooseBase$8(this,_nodeIsEmpty)[_nodeIsEmpty](e)&&e.childNodes.length>0)&&(e=_classPrivateFieldLooseBase$8(this,_clearChildNodes)[_clearChildNodes](e)),_classPrivateFieldLooseBase$8(this,_cachedElements)[_cachedElements].has(e)||_classPrivateFieldLooseBase$8(this,_cachedElements)[_cachedElements].set(e,_classPrivateFieldLooseBase$8(this,_parseElement)[_parseElement](e)),a?new Promise((s,a)=>(_classPrivateFieldLooseBase$8(this,_appendChildNodes)[_appendChildNodes](e,_classPrivateFieldLooseBase$8(this,_processChildren)[_processChildren](t)),s(e))):_classPrivateFieldLooseBase$8(this,_renderHTML)[_renderHTML](e,_classPrivateFieldLooseBase$8(this,_processChildren)[_processChildren](t))}replace(...e){return this.render(...e,!0)}}var _context$5=_classPrivateFieldLooseKey$8("context"),_cachedElements=_classPrivateFieldLooseKey$8("cachedElements"),_parser=_classPrivateFieldLooseKey$8("parser"),_trash=_classPrivateFieldLooseKey$8("trash"),_boundNodes=_classPrivateFieldLooseKey$8("boundNodes"),_addAttributes=_classPrivateFieldLooseKey$8("addAttributes"),_removeAttributes=_classPrivateFieldLooseKey$8("removeAttributes"),_addListeners=_classPrivateFieldLooseKey$8("addListeners"),_removeListeners=_classPrivateFieldLooseKey$8("removeListeners"),_appendChildNode=_classPrivateFieldLooseKey$8("appendChildNode"),_appendChildNodes=_classPrivateFieldLooseKey$8("appendChildNodes"),_clearChildNodes=_classPrivateFieldLooseKey$8("clearChildNodes"),_createNode=_classPrivateFieldLooseKey$8("createNode"),_nodeIsEmpty=_classPrivateFieldLooseKey$8("nodeIsEmpty"),_parseElement=_classPrivateFieldLooseKey$8("parseElement"),_processChildren=_classPrivateFieldLooseKey$8("processChildren"),_processCustomElement=_classPrivateFieldLooseKey$8("processCustomElement"),_processTemplate=_classPrivateFieldLooseKey$8("processTemplate"),_processVirtualNode=_classPrivateFieldLooseKey$8("processVirtualNode"),_reconcileAttributes=_classPrivateFieldLooseKey$8("reconcileAttributes"),_reconcileListeners=_classPrivateFieldLooseKey$8("reconcileListeners"),_reconcileChildNodes=_classPrivateFieldLooseKey$8("reconcileChildNodes"),_reconcileNodes=_classPrivateFieldLooseKey$8("reconcileNodes"),_replaceChildNode=_classPrivateFieldLooseKey$8("replaceChildNode"),_renderHTML=_classPrivateFieldLooseKey$8("renderHTML");function _classPrivateFieldLooseBase$9(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var id$9=0;function _classPrivateFieldLooseKey$9(e){return"__private_"+id$9+++"_"+e}class Interface{constructor(e={}){Object.defineProperty(this,_cfg$2,{writable:!0,value:void 0}),Object.defineProperty(this,_parent$1,{writable:!0,value:void 0}),Object.defineProperty(this,_id,{writable:!0,value:Utilities.createGUID()}),Object.defineProperty(this,_namespace$1,{writable:!0,value:void 0}),Object.defineProperty(this,_selector,{writable:!0,value:void 0}),Object.defineProperty(this,_children,{writable:!0,value:void 0}),Object.defineProperty(this,_eventManager,{writable:!0,value:void 0}),Object.defineProperty(this,_propertyManager,{writable:!0,value:void 0}),Object.defineProperty(this,_referenceManager$1,{writable:!0,value:void 0}),Object.defineProperty(this,_stateManager,{writable:!0,value:void 0}),Object.defineProperty(this,_reactionManager,{writable:!0,value:void 0}),Object.defineProperty(this,_renderer,{writable:!0,value:new Renderer(this)}),Object.defineProperty(this,_initialized,{writable:!0,value:!1}),Object.defineProperty(this,_wasVisible,{writable:!0,value:null}),Object.defineProperty(this,_wasCompletelyVisible,{writable:!0,value:null}),this.boundData=null,Object.defineProperty(this,_handleScroll,{writable:!0,value:e=>{this.isCompletelyVisible?_classPrivateFieldLooseBase$9(this,_wasCompletelyVisible)[_wasCompletelyVisible]||this.emit("entered-viewport"):this.isVisible?(_classPrivateFieldLooseBase$9(this,_wasCompletelyVisible)[_wasCompletelyVisible]&&this.emit("exiting-viewport"),_classPrivateFieldLooseBase$9(this,_wasVisible)[_wasVisible]||this.emit("entering-viewport")):_classPrivateFieldLooseBase$9(this,_wasVisible)[_wasVisible]&&this.emit("exited-viewport"),_classPrivateFieldLooseBase$9(this,_wasVisible)[_wasVisible]=this.isVisible,_classPrivateFieldLooseBase$9(this,_wasCompletelyVisible)[_wasCompletelyVisible]=this.isCompletelyVisible}}),_classPrivateFieldLooseBase$9(this,_cfg$2)[_cfg$2]=e,_classPrivateFieldLooseBase$9(this,_namespace$1)[_namespace$1]=NGN.coalesce(e.namespace,_classPrivateFieldLooseBase$9(this,_id)[_id]),_classPrivateFieldLooseBase$9(this,_selector)[_selector]=NGN.coalesce(e.selector),_classPrivateFieldLooseBase$9(this,_children)[_children]=NGN.coalesce(e.children),_classPrivateFieldLooseBase$9(this,_eventManager)[_eventManager]=new EventManager(this,e),_classPrivateFieldLooseBase$9(this,_propertyManager)[_propertyManager]=new PropertyManager(this,NGN.coalesce(e.properties)),_classPrivateFieldLooseBase$9(this,_stateManager)[_stateManager]=new StateManager(this,NGN.coalesce(e.states),NGN.coalesce(e.initialState)),_classPrivateFieldLooseBase$9(this,_referenceManager$1)[_referenceManager$1]=new ReferenceManager(this,NGN.coalesce(e.references)),_classPrivateFieldLooseBase$9(this,_reactionManager)[_reactionManager]=new ReactionManager(this,NGN.coalesce(e.reactions))}get config(){return _classPrivateFieldLooseBase$9(this,_cfg$2)[_cfg$2]}get parent(){return _classPrivateFieldLooseBase$9(this,_parent$1)[_parent$1]}get selector(){return _classPrivateFieldLooseBase$9(this,_selector)[_selector]?_classPrivateFieldLooseBase$9(this,_selector)[_selector].startsWith("#")?this.selector:`${this.parent?`${this.parent.selector} `:""}${_classPrivateFieldLooseBase$9(this,_selector)[_selector]}`:null}get namespace(){return`${this.parent?`${this.parent.namespace}.`:""}${_classPrivateFieldLooseBase$9(this,_namespace$1)[_namespace$1]}`}get properties(){return _classPrivateFieldLooseBase$9(this,_propertyManager)[_propertyManager].properties}get props(){return this.properties}get self(){return _classPrivateFieldLooseBase$9(this,_referenceManager$1)[_referenceManager$1].getReference("self")}get state(){return _classPrivateFieldLooseBase$9(this,_stateManager)[_stateManager].current?_classPrivateFieldLooseBase$9(this,_stateManager)[_stateManager].current.name:null}set state(e){_classPrivateFieldLooseBase$9(this,_stateManager)[_stateManager].current=e}get states(){return _classPrivateFieldLooseBase$9(this,_stateManager)[_stateManager].states}get references(){return _classPrivateFieldLooseBase$9(this,_referenceManager$1)[_referenceManager$1].references}get refs(){return this.references}get type(){return"interface"}get isVisible(){return Utilities.elementIsVisible(this.self.element,!0)}get isCompletelyVisible(){return Utilities.elementIsVisible(this.self.element)}initialize(e=null,t=null){let s=new NGN.Tasks;s.on("complete",()=>{_classPrivateFieldLooseBase$9(this,_initialized)[_initialized]=!0,this.emit("initialized")}),s.add("Initializing Renderer",e=>{_classPrivateFieldLooseBase$9(this,_renderer)[_renderer].clearCache(),e()}),s.add("Initializing Properties",e=>{_classPrivateFieldLooseBase$9(this,_propertyManager)[_propertyManager].initialize(),e()}),_classPrivateFieldLooseBase$9(this,_initialized)[_initialized]||(s.add("Connecting Parent Interface",t=>{_classPrivateFieldLooseBase$9(this,_parent$1)[_parent$1]=NGN.coalesce(e,_classPrivateFieldLooseBase$9(this,_parent$1)[_parent$1]),t()}),s.add("Initializing Event Bus",e=>{_classPrivateFieldLooseBase$9(this,_eventManager)[_eventManager].initialize(),e()}),s.add("Initializing Reactions",e=>{_classPrivateFieldLooseBase$9(this,_reactionManager)[_reactionManager].initialize(),e()})),s.add("Initializing References",e=>{_classPrivateFieldLooseBase$9(this,_referenceManager$1)[_referenceManager$1].initialize(t),e()}),s.add("Firing Hook Events",e=>{this.emit("initialize"),e()}),!_classPrivateFieldLooseBase$9(this,_initialized)[_initialized]&&_classPrivateFieldLooseBase$9(this,_children)[_children]&&s.add("Initializing Children",e=>{_classPrivateFieldLooseBase$9(this,_children)[_children].forEach(e=>e.initialize(this)),e()}),s.add("Initializing State Machine",e=>{_classPrivateFieldLooseBase$9(this,_stateManager)[_stateManager].initialize(),e()}),s.run(!0)}bind(e,t=null){this.boundData=t;let s=_classPrivateFieldLooseBase$9(this,_renderer)[_renderer].createVirtualNode(...e);return s.interface=this,s}emit(){_classPrivateFieldLooseBase$9(this,_eventManager)[_eventManager].emit(...arguments)}on(){_classPrivateFieldLooseBase$9(this,_eventManager)[_eventManager].on(...arguments)}off(){_classPrivateFieldLooseBase$9(this,_eventManager)[_eventManager].off(...arguments)}once(){_classPrivateFieldLooseBase$9(this,_eventManager)[_eventManager].once(...arguments)}pool(){_classPrivateFieldLooseBase$9(this,_eventManager)[_eventManager].pool(...arguments)}addState(e,t){_classPrivateFieldLooseBase$9(this,_stateManager)[_stateManager].add(...arguments)}removeState(e){_classPrivateFieldLooseBase$9(this,_stateManager)[_stateManager].remove(...arguments)}hasState(e){return _classPrivateFieldLooseBase$9(this,_stateManager)[_stateManager].has(...arguments)}setState(e,...t){_classPrivateFieldLooseBase$9(this,_stateManager)[_stateManager].setState(...arguments)}transition(e,...t){_classPrivateFieldLooseBase$9(this,_stateManager)[_stateManager].transition(...arguments)}addReference(e,t){_classPrivateFieldLooseBase$9(this,_referenceManager$1)[_referenceManager$1].add(...arguments)}removeReference(e){_classPrivateFieldLooseBase$9(this,_referenceManager$1)[_referenceManager$1].remove(...arguments)}destroy(){this.self.element.parentNode.removeChild(this.self.element)}enableScrollMonitor(){_classPrivateFieldLooseBase$9(this,_wasVisible)[_wasVisible]=this.isVisible,_classPrivateFieldLooseBase$9(this,_wasCompletelyVisible)[_wasCompletelyVisible]=this.isCompletelyVisible,window.addEventListener("scroll",e=>_classPrivateFieldLooseBase$9(this,_handleScroll)[_handleScroll](e))}disableScrollMonitor(){_classPrivateFieldLooseBase$9(this,_wasVisible)[_wasVisible]=null,_classPrivateFieldLooseBase$9(this,_wasCompletelyVisible)[_wasCompletelyVisible]=null,window.removeEventListener("scroll",e=>_classPrivateFieldLooseBase$9(this,_handleScroll)[_handleScroll](e))}appendHTML(e=null,t=null){return this.renderHTML(e,t,!1,!0)}generateHTML(e){return _classPrivateFieldLooseBase$9(this,_renderer)[_renderer].generateHTML(e)}replaceHTML(e=null,t=null){this.renderHTML(e,t,!0)}renderHTML(){return _classPrivateFieldLooseBase$9(this,_renderer)[_renderer].render(...arguments)}}var _cfg$2=_classPrivateFieldLooseKey$9("cfg"),_parent$1=_classPrivateFieldLooseKey$9("parent"),_id=_classPrivateFieldLooseKey$9("id"),_namespace$1=_classPrivateFieldLooseKey$9("namespace"),_selector=_classPrivateFieldLooseKey$9("selector"),_children=_classPrivateFieldLooseKey$9("children"),_eventManager=_classPrivateFieldLooseKey$9("eventManager"),_propertyManager=_classPrivateFieldLooseKey$9("propertyManager"),_referenceManager$1=_classPrivateFieldLooseKey$9("referenceManager"),_stateManager=_classPrivateFieldLooseKey$9("stateManager"),_reactionManager=_classPrivateFieldLooseKey$9("reactionManager"),_renderer=_classPrivateFieldLooseKey$9("renderer"),_initialized=_classPrivateFieldLooseKey$9("initialized"),_wasVisible=_classPrivateFieldLooseKey$9("wasVisible"),_wasCompletelyVisible=_classPrivateFieldLooseKey$9("wasCompletelyVisible"),_handleScroll=_classPrivateFieldLooseKey$9("handleScroll");function _classPrivateFieldLooseBase$a(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var id$a=0;function _classPrivateFieldLooseKey$a(e){return"__private_"+id$a+++"_"+e}class Route{constructor(e,t,s=null){if(Object.defineProperty(this,_parent$2,{writable:!0,value:void 0}),Object.defineProperty(this,_renderFn$1,{writable:!0,value:void 0}),Object.defineProperty(this,_typeof$3,{writable:!0,value:e=>Array.isArray(e)?"array":typeof e}),_classPrivateFieldLooseBase$a(this,_parent$2)[_parent$2]=s,this.name=s?`${s.name}.${e}`:e,this.subroutes=NGN.coalesce(t.routes,null),"object"!==_classPrivateFieldLooseBase$a(this,_typeof$3)[_typeof$3](t))return console.error(`Route "${e}": Invalid type [${type}]. Routes configurations must be defined as objects.`);let a=NGN.coalesce(t.path,"/");this.path=s?`${s.path}${a}`:a,_classPrivateFieldLooseBase$a(this,_renderFn$1)[_renderFn$1]=NGN.coalesce(t.render)}get rendersHTML(){return!!_classPrivateFieldLooseBase$a(this,_renderFn$1)[_renderFn$1]}render(e,t){return _classPrivateFieldLooseBase$a(this,_renderFn$1)[_renderFn$1]?_classPrivateFieldLooseBase$a(this,_renderFn$1)[_renderFn$1](...arguments):null}}var _parent$2=_classPrivateFieldLooseKey$a("parent"),_renderFn$1=_classPrivateFieldLooseKey$a("renderFn"),_typeof$3=_classPrivateFieldLooseKey$a("typeof");function _classPrivateFieldLooseBase$b(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var id$b=0;function _classPrivateFieldLooseKey$b(e){return"__private_"+id$b+++"_"+e}class RouteManager{constructor(e,t,s){Object.defineProperty(this,_context$6,{writable:!0,value:null}),Object.defineProperty(this,_routes,{writable:!0,value:{}}),Object.defineProperty(this,_defaultRoute,{writable:!0,value:null}),Object.defineProperty(this,_state,{writable:!0,value:{previous:null,current:null}}),Object.defineProperty(this,_registerRoutes,{writable:!0,value:(e,t=null)=>{for(let s in e)this.add(s,e[s],t)}}),_classPrivateFieldLooseBase$b(this,_context$6)[_context$6]=e,s||t.hasOwnProperty("default")||(t.default={}),_classPrivateFieldLooseBase$b(this,_registerRoutes)[_registerRoutes](t),_classPrivateFieldLooseBase$b(this,_defaultRoute)[_defaultRoute]=_classPrivateFieldLooseBase$b(this,_routes)[_routes][NGN.coalesce(s,"default")]}get current(){return history.state?this.get(history.state.route):null}get previous(){return _classPrivateFieldLooseBase$b(this,_state)[_state].previous}get routes(){return _classPrivateFieldLooseBase$b(this,_routes)[_routes]}get defaultRoute(){return _classPrivateFieldLooseBase$b(this,_defaultRoute)[_defaultRoute]}set defaultRoute(e){if(!_classPrivateFieldLooseBase$b(this,_routes)[_routes].hasOwnProperty(e))return console.error(`Route "${e}" not found`);_classPrivateFieldLooseBase$b(this,_defaultRoute)[_defaultRoute]=_classPrivateFieldLooseBase$b(this,_routes)[_routes][e]}add(e,t,s){if(this.has(e))return console.error(`Route "${e}" already exists`);let a=NGN.typeof(t);if("object"!==a)return console.error(`Invalid route configuration type "${a}"`);e=new Route(...arguments),_classPrivateFieldLooseBase$b(this,_routes)[_routes][e.name]=e,t.hasOwnProperty("routes")&&_classPrivateFieldLooseBase$b(this,_registerRoutes)[_registerRoutes](t.routes,{name:e.name,path:e.path})}back(){this.navigate("previous")}get(e){return this.has(e)?_classPrivateFieldLooseBase$b(this,_routes)[_routes][e]:(console.error(`Route "${e}" not found.`),null)}has(e){return _classPrivateFieldLooseBase$b(this,_routes)[_routes].hasOwnProperty(e)}navigate(e,t=null){if("previous"===e)return history.back();if(!this.has(e))return console.error(`Invalid route "${e}"`);let s={route:{name:(e=this.get(e)).name,path:this.parseRoute(e.path,t)},data:t};window.history.pushState(s,s.route.name,s.route.path),dispatchEvent(new PopStateEvent("popstate",{state:s}))}parseRoute(e,t=null){if(!t)return e;return"/"+e.split("/").filter(Boolean).map(e=>{if(!e.startsWith(":"))return e;let s=t[e.substring(1)];return s||console.error(`Data object does not contain a property called "${e.substring(1)}"`)}).join("/")}initialize(){window.addEventListener("popstate",e=>{e.preventDefault(),e.stopPropagation();let t=this.get(e.state.route.name),{data:s}=e.state;if(_classPrivateFieldLooseBase$b(this,_state)[_state].previous=_classPrivateFieldLooseBase$b(this,_state)[_state].current,_classPrivateFieldLooseBase$b(this,_state)[_state].current={route:t.name,data:s},t.rendersHTML){let e=t.render(_classPrivateFieldLooseBase$b(this,_state)[_state].previous,s);"array"===NGN.typeof(e)&&e.length>0&&_classPrivateFieldLooseBase$b(this,_context$6)[_context$6].replaceHTML(e)}_classPrivateFieldLooseBase$b(this,_context$6)[_context$6].emit("route.change",{old:_classPrivateFieldLooseBase$b(this,_state)[_state].previous,new:_classPrivateFieldLooseBase$b(this,_state)[_state].current})}),this.navigate(_classPrivateFieldLooseBase$b(this,_defaultRoute)[_defaultRoute].name)}}var _context$6=_classPrivateFieldLooseKey$b("context"),_routes=_classPrivateFieldLooseKey$b("routes"),_defaultRoute=_classPrivateFieldLooseKey$b("defaultRoute"),_state=_classPrivateFieldLooseKey$b("state"),_registerRoutes=_classPrivateFieldLooseKey$b("registerRoutes");function _classPrivateFieldLooseBase$c(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var id$c=0;function _classPrivateFieldLooseKey$c(e){return"__private_"+id$c+++"_"+e}class Router extends Interface{constructor(e){super(e),Object.defineProperty(this,_routeManager,{writable:!0,value:void 0}),Object.defineProperty(this,_initialized$1,{writable:!0,value:!1}),_classPrivateFieldLooseBase$c(this,_routeManager)[_routeManager]=new RouteManager(this,NGN.coalesce(e.routes,{}),NGN.coalesce(e.defaultRoute))}get currentRoute(){return _classPrivateFieldLooseBase$c(this,_routeManager)[_routeManager].current}get previousRoute(){return _classPrivateFieldLooseBase$c(this,_routeManager)[_routeManager].previous}get defaultRoute(){return _classPrivateFieldLooseBase$c(this,_routeManager)[_routeManager].defaultRoute}set defaultRoute(e){_classPrivateFieldLooseBase$c(this,_routeManager)[_routeManager].defaultRoute=e}get routes(){return _classPrivateFieldLooseBase$c(this,_routeManager)[_routeManager].routes}get type(){return"router"}initialize(){_classPrivateFieldLooseBase$c(this,_initialized$1)[_initialized$1]||_classPrivateFieldLooseBase$c(this,_routeManager)[_routeManager].initialize(),super.initialize(...arguments),_classPrivateFieldLooseBase$c(this,_initialized$1)[_initialized$1]=!0}addRoute(e,t){_classPrivateFieldLooseBase$c(this,_routeManager)[_routeManager].add(...arguments)}navigate(e,t){_classPrivateFieldLooseBase$c(this,_routeManager)[_routeManager].navigate(...arguments)}}var _routeManager=_classPrivateFieldLooseKey$c("routeManager"),_initialized$1=_classPrivateFieldLooseKey$c("initialized");function _classPrivateFieldLooseBase$d(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var id$d=0;function _classPrivateFieldLooseKey$d(e){return"__private_"+id$d+++"_"+e}const CustomElement=e=>{var t,s,a,r,i;return t=class extends(NGN.coalesce(e.extends,HTMLElement)){constructor(){super(),Object.defineProperty(this,s,{writable:!0,value:void 0}),Object.defineProperty(this,a,{writable:!0,value:void 0}),Object.defineProperty(this,r,{writable:!0,value:void 0}),Object.defineProperty(this,i,{writable:!0,value:new Renderer(this)}),_classPrivateFieldLooseBase$d(this,s)[s]=e,_classPrivateFieldLooseBase$d(this,a)[a]=NGN.coalesce(e.template,[["slot"]]),this.attachShadow({mode:NGN.coalesce(e.mode,"open")});let t=document.createElement("div");t.insertAdjacentHTML("afterbegin",`<template>${this.template}</template>`);let o=t.querySelector("template");"content"in o?this.shadowRoot.appendChild(o.content.cloneNode(!0)):o.childNodes.forEach(e=>{this.shadowRoot.appendChild(e.cloneNode(!0))}),o=null}get config(){return _classPrivateFieldLooseBase$d(this,s)[s]}get template(){return _classPrivateFieldLooseBase$d(this,i)[i].generateHTML(_classPrivateFieldLooseBase$d(this,a)[a])}emit(e=null,t,s={bubbles:!1,cancelable:!1,composed:!1}){if("string"==typeof arguments[0]&&(e=arguments[0],t=arguments[1]||null),!e)return console.error("Event name is required");let a=new CustomEvent(e,Object.assign({},s,{detail:t}));return this.dispatchEvent(a),a}},s=_classPrivateFieldLooseKey$d("cfg"),a=_classPrivateFieldLooseKey$d("template"),r=_classPrivateFieldLooseKey$d("eventManager"),i=_classPrivateFieldLooseKey$d("renderer"),t},JET={};NGN?(JET.EventEmitter=NGN.EventEmitter,JET.Utilities=Utilities,JET.Bus=NGN.BUS,JET.Interface=Interface,JET.Template=Template,JET.Router=Router,JET.CustomElement=CustomElement,JET.ready=function(e){let t=function(){e(),document.removeEventListener("DOMContentLoaded",t)};document.addEventListener("DOMContentLoaded",t)}):console.error("Jet requires NGN. See https://github.com/ngnjs/NGN"),Object.freeze(JET),window.JET=JET;export default JET;
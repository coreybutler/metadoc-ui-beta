import API from"./client.js";var Signup=new JET.Interface({namespace:"section.signup .width.constraint",properties:{submitDisabled:!1},references:{emailControl:"author-control.email"},states:{idle:{on(e,t){this.emit("render",!1,t)},transitions:{REGISTER:"loading"}},loading:{on(){this.emit("render",!0)},transitions:{TRYAGAIN:"idle",DUPLICATE:"duplicate",REGISTERED:"registered"}},duplicate:{transitions:{TRYAGAIN:"idle"},on(e,t){this.replaceHTML([["div",{class:"duplicate result"},[["p",{class:"text-bold"},["".concat(t," is already signed up for updates!")]],["footer",[["a",{href:"#"},{click:e=>{e.preventDefault(),this.transition("TRYAGAIN")}},["Sign up with another email address"]]]]]]])}},registered:{transitions:{TRYAGAIN:"idle"},on(e,t){this.replaceHTML([["div",{class:"registered result"},[["p",{class:"text-bold"},["Thank you for registering! You will receive updates at:"]],["div",{class:"email"},[t]],["footer",["Wrong email? ",["a",{class:"reset",href:"#"},{click:e=>{e.preventDefault(),this.transition("TRYAGAIN")}},["Try Again"]]]]]]])}}},on:{email:{submit(e){this.transition("REGISTER"),NGN.NET.post({url:"https://us-central1-metadoc-4ebc3.cloudfunctions.net/api/user",json:{email:e}},t=>{switch(t.status){case 400:case 403:return this.transition("TRYAGAIN",t.responseText);case 201:API.register(e,NGN.DATA.util.GUID(),(t,s)=>{if(t){switch(t.code){case"auth/email-already-in-use":this.transition("DUPLICATE",e)}return console.log(t)}this.transition("REGISTERED",e)})}})}},property:{submitDisabled:{changed(e){this.emit("render")}}},render(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0,{submitDisabled:s}=this.properties;this.renderHTML([["p",{class:"text-bold"},["Sign up to be the first to hear about updates!"]],["author-control",{class:[{disabled:e,error:!!t},"email"]},[["div",{class:"input"},[["div",{class:"wrapper"},[["author-icon",{src:"assets/icons/mail.svg"}],["input",{type:"text",placeholder:"Enter your email address"},{keydown:e=>{"Enter"===e.key&&this.emit("email.submit",this.refs.emailControl.value)},input:e=>this.properties.submitDisabled=""===e.target.value||!e.target.value}]]],!!t&&["div",{class:"error"},[["author-icon",{src:"assets/icons/alert.svg"}],["span",{class:"message"},[t]]]]]],["button",{disabled:s,class:[{loading:e},"submit"]},{click:e=>{e.preventDefault(),this.emit("email.submit",this.refs.emailControl.value)}},[["span",{class:"label"},["Stay Informed"]],["md-loader"]]]]]])}}});export default Signup;